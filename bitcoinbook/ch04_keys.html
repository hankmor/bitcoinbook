<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.22">
<title>Keys and Addresses</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="ch04_keys_addresses">Keys and Addresses</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Alice wants to pay Bob, but the thousands of Bitcoin full nodes who
will verify her transaction don&#8217;t know who Alice or Bob are&#8212;&#8203;and we want
to keep it that way to protect their privacy.  Alice needs to
communicate that Bob should receive some of her bitcoins without tying
any aspect of that transaction to Bob&#8217;s real-world identity or to other
Bitcoin payments that Bob receives.  The method Alice uses must ensure
that only Bob can further spend the bitcoins he receives.</p>
</div>
<div class="paragraph">
<p>The original Bitcoin paper describes a very simple scheme for achieving
those goals, shown in <a href="#pay-to-pure-pubkey">Transaction chain from original Bitcoin paper.</a>.</p>
</div>
<div id="pay-to-pure-pubkey" class="imageblock">
<div class="content">
<img src="images/mbc3_aain01.png" alt="Transaction chain from original Bitcoin paper">
</div>
<div class="title">Figure 1. Transaction chain from original Bitcoin paper.</div>
</div>
<div class="paragraph">
<p>A receiver like Bob
accepts bitcoins to a public key in a transaction that is signed by the
spender (like Alice).  The bitcoins that Alice is spending had been
previously received to one of her public keys, and she uses the
corresponding private key to generate her signature.  Full nodes can
verify that Alice&#8217;s signature commits to the output of a hash function
that itself commits to Bob&#8217;s public key and other transaction details.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll examine public keys, private keys, signatures, and hash functions
in this chapter, and then use all of them together to describe
the addresses used by modern Bitcoin software.</p>
</div>
<div class="sect2">
<h3 id="_public_key_cryptography">Public Key Cryptography</h3>
<div class="paragraph">
<p>Public key
cryptography was invented in the 1970s and is a mathematical foundation
for modern computer and information security.</p>
</div>
<div class="paragraph">
<p>Since the invention of public key cryptography, several suitable
mathematical functions, such as prime number exponentiation and elliptic
curve multiplication, have been discovered. These mathematical functions
are easy to calculate in
one direction and infeasible to calculate in the opposite direction
using the computers and algorithms available today.
Based on these mathematical functions, cryptography enables the creation
of unforgeable digital signatures. Bitcoin uses
elliptic curve addition and multiplication as the basis for its cryptography.</p>
</div>
<div class="paragraph">
<p>In Bitcoin, we can use public key cryptography to create a key pair that
controls access to bitcoins. The key pair consists of a private key
and a public key derived from the private key. The public key is used to
receive funds, and the private key is used to sign transactions to spend
the funds.</p>
</div>
<div class="paragraph">
<p>There is a mathematical relationship between the public and the private
key that allows the private key to be used to generate signatures on
messages. These signatures can be validated against the public key without
revealing the private key.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>In some wallet
implementations, the private and public keys are stored together as a
<em>key pair</em> for convenience. However, the public key can be calculated
from the private key, so storing only the private key is also possible.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A Bitcoin wallet contains a collection of key
pairs, each consisting of a private key and a public key. The private
key (<em>k</em>) is a number, usually derived from a number picked at random.
From the private key, we
use elliptic curve multiplication, a one-way cryptographic function, to
generate a public key (<em>K</em>).</p>
</div>
<div class="sidebarblock less_space pagebreak-before">
<div class="content">
<div class="title">Why Use Asymmetric Cryptography (Public/Private Keys)?</div>
<div class="paragraph">
<p>Why is asymmetric
cryptography used in Bitcoin? It&#8217;s not used to "encrypt" (make secret)
the transactions. Rather, a useful property of asymmetric cryptography
is the ability to generate <em>digital signatures</em>. A private key can be
applied to a transaction to produce a
numerical signature. This signature can only be produced by someone with
knowledge of the private key. However, anyone with access to the public
key and the transaction can use them to <em>verify</em> the
signature. This useful property of asymmetric cryptography makes it
possible for anyone to verify every signature on every transaction,
while ensuring that only the owners of private keys can produce valid
signatures.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="private_keys">Private Keys</h4>
<div class="paragraph">
<p>A
private key is simply a number, picked at random.  Control
over the private key is the root of user control over all funds
associated with the corresponding Bitcoin public key. The private key is
used to create signatures that are used to spend bitcoins by proving
control of funds used in a transaction. The private key must remain
secret at all times because revealing it to third parties is equivalent
to giving them control over the bitcoins secured by that key. The private
key must also be backed up and protected from accidental loss because
if it&#8217;s lost, it cannot be recovered and the funds secured by it are
forever lost too.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>A Bitcoin private key is just a number. You can pick your private keys
randomly using just a coin, pencil, and paper: toss a coin 256 times and
you have the binary digits of a random private key you can use in a
Bitcoin wallet. The public key can then be generated from the private
key.  Be careful, though, as any process that&#8217;s less than completely
random can significantly reduce the security of your private key and the
bitcoins it controls.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The first and most important step in generating keys is to find a secure
source of randomness (which computer scientists call <em>entropy</em>). Creating a Bitcoin key is almost
the same as "Pick a number between 1 and 2<sup>256</sup>." The exact method you
use to pick that number does not matter as long as it is not predictable
or repeatable. Bitcoin software uses cryptographically secure random
number generators to produce 256 bits of entropy.</p>
</div>
<div class="paragraph less_space pagebreak-before">
<p>More precisely, the private key can be any number between 0 and <em>n</em> -
1 inclusive, where <em>n</em> is a constant (<em>n</em> = 1.1578 × 10<sup>77</sup>, slightly less
than 2<sup>256</sup>) defined as the order of the elliptic curve used in Bitcoin
(see <a href="#elliptic_curve">Elliptic Curve Cryptography Explained</a>). To create such a key, we randomly pick a
256-bit number and check that it is less than <em>n</em>. In programming terms,
this is usually achieved by feeding a larger string of random bits,
collected from a cryptographically secure source of randomness, into the
SHA256 hash algorithm, which will conveniently produce a 256-bit value
that can be interpreted as a number.
If the result is less than <em>n</em>, we have a suitable private key.
Otherwise, we simply try again with another random number.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Do not write your own code to create a random
number or use a "simple" random number generator offered by your
programming language. Use a cryptographically secure pseudorandom number
generator (CSPRNG) with a seed from a source of sufficient entropy.
Study the documentation of the random number generator library you
choose to make sure it is cryptographically secure. Correct
implementation of the CSPRNG is critical to the security of the keys.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following is a randomly generated private key (<em>k</em>) shown in
hexadecimal format (256 bits shown as 64 hexadecimal digits, each 4
bits):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>The size of Bitcoin&#8217;s private key space (2<sup>256</sup>) is an unfathomably
large number. It is approximately 10<sup>77</sup> in decimal. For comparison, the
visible universe is estimated to contain 10<sup>80</sup> atoms.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="elliptic_curve">Elliptic Curve Cryptography Explained</h4>
<div class="paragraph">
<p>Elliptic curve cryptography (ECC) is a type of asymmetric
or public key cryptography based on the discrete logarithm problem as
expressed by addition and multiplication on the points of an elliptic
curve.</p>
</div>
<div class="paragraph">
<p><a href="#ecc-curve">An elliptic curve.</a> is an example of an elliptic curve, similar to that used
by Bitcoin.</p>
</div>
<div id="ecc-curve" class="imageblock width-50">
<div class="content">
<img src="images/mbc3_0402.png" alt="ecc-curve">
</div>
<div class="title">Figure 2. An elliptic curve.</div>
</div>
<div class="paragraph">
<p>Bitcoin uses a specific elliptic curve and set of mathematical
constants, as defined in a standard called secp256k1, established by
the National Institute of Standards and Technology (NIST). The
secp256k1 curve is defined by the following function, which produces
an elliptic curve:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
{y^2 = (x^3 + 7)}~\text{over}~(\mathbb{F}_p)
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
{y^2 \mod p = (x^3 + 7) \mod p}
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>The <em>mod p</em> (modulo prime number <em>p</em>) indicates that this curve is over a
finite field of prime order <em>p</em>, also written as \(\(
\mathbb{F}_p\)\), where <em>p</em> = 2<sup>256</sup> – 2<sup>32</sup> – 2<sup>9</sup> – 2<sup>8</sup> – 2<sup>7</sup> – 2<sup>6</sup> –
2<sup>4</sup> – 1, a very large prime number.</p>
</div>
<div class="paragraph">
<p>Because this curve is defined over a finite field of prime order instead
of over the real numbers, it looks like a pattern of dots scattered in
two dimensions, which makes it difficult to visualize. However, the math
is identical to that of an elliptic curve over real numbers. As an
example, <a href="#ecc-over-F17-math">Elliptic curve cryptography: visualizing an elliptic curve over F(p), with p=17.</a> shows the same elliptic curve over a much
smaller finite field of prime order 17, showing a pattern of dots on a
grid. The secp256k1 Bitcoin elliptic curve can be thought of as a much
more complex pattern of dots on a unfathomably large grid.</p>
</div>
<div id="ecc-over-F17-math" class="imageblock">
<div class="content">
<img src="images/mbc3_0403.png" alt="ecc-over-F17-math">
</div>
<div class="title">Figure 3. Elliptic curve cryptography: visualizing an elliptic curve over F(p), with p=17.</div>
</div>
<div class="paragraph">
<p>So, for example, the following is a point P with coordinates (x, y) that
is a point on the secp256k1 curve:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">P =
(55066263022277343669578718895168534326250603453777594175500187360389116729240,
32670510020758816978083085130507043184471273380659243275938904335757337482424)</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#example_4_1">Using Python to confirm that this point is on the elliptic curve</a> shows how you can check this yourself using Python.</p>
</div>
<div id="example_4_1" class="exampleblock">
<div class="title">Example 1. Using Python to confirm that this point is on the elliptic curve</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-pycon" data-lang="pycon">Python 3.10.6 (main, Nov 14 2022, 16:10:14) [GCC 11.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
&gt; p = 115792089237316195423570985008687907853269984665640564039457584007908834671663
&gt; x = 55066263022277343669578718895168534326250603453777594175500187360389116729240
&gt; y = 32670510020758816978083085130507043184471273380659243275938904335757337482424
&gt; (x ** 3 + 7 - y**2) % p
0</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph less_space pagebreak-before">
<p>In elliptic curve math, there is a point called the "point at infinity,"
which roughly corresponds to the role of zero in addition. On computers,
it&#8217;s sometimes represented by x = y = 0 (which doesn&#8217;t satisfy the
elliptic curve equation, but it&#8217;s an easy separate case that can be
checked).</p>
</div>
<div class="paragraph">
<p>There is also a + operator, called "addition," which has some
properties similar to the traditional addition of real numbers that
gradeschool children learn. Given two points P<sub>1</sub> and P<sub>2</sub> on the
elliptic curve, there is a third point P<sub>3</sub> = P<sub>1</sub> + P<sub>2</sub>, also on the
elliptic curve.</p>
</div>
<div class="paragraph">
<p>Geometrically, this third point P<sub>3</sub> is calculated by drawing a line
between P<sub>1</sub> and P<sub>2</sub>. This line will intersect the elliptic curve in
exactly one additional place. Call this point P<sub>3</sub>' = (x, y). Then
reflect in the x-axis to get P<sub>3</sub> = (x, –y).</p>
</div>
<div class="paragraph">
<p>There are a couple of special cases that explain the need for the "point
at infinity."</p>
</div>
<div class="paragraph">
<p>If P<sub>1</sub> and P<sub>2</sub> are the same point, the line "between" P<sub>1</sub> and P<sub>2</sub>
should extend to be the tangent on the curve at this point P<sub>1</sub>. This
tangent will intersect the curve in exactly one new point. You can use
techniques from calculus to determine the slope of the tangent line.
These techniques curiously work, even though we are restricting our
interest to points on the curve with two integer coordinates!</p>
</div>
<div class="paragraph">
<p>In some cases (i.e., if P<sub>1</sub> and P<sub>2</sub> have the same x values but
different y values), the tangent line will be exactly vertical, in which
case P<sub>3</sub> = "point at infinity."</p>
</div>
<div class="paragraph">
<p>If P<sub>1</sub> is the "point at infinity," then P<sub>1</sub> + P<sub>2</sub> = P<sub>2</sub>. Similarly,
if P<sub>2</sub> is the point at infinity, then P<sub>1</sub> + P<sub>2</sub> = P<sub>1</sub>. This shows
how the point at infinity plays the role of zero.</p>
</div>
<div class="paragraph">
<p>It turns out that + is associative, which means that (A +
B) + C = A + (B + C). That means we can write A
+ B + C without parentheses and without ambiguity.</p>
</div>
<div class="paragraph">
<p>Now that we have defined addition, we can define multiplication in the
standard way that extends addition. For a point P on the elliptic curve,
if k is a whole number, then kP = P + P + P + &#8230;&#8203; + P (k times). Note
that k is sometimes confusingly called an "exponent" in this case.</p>
</div>
</div>
<div class="sect3">
<h4 id="public_key_derivation">Public Keys</h4>
<div class="paragraph">
<p>The public key is calculated from
the private key using elliptic curve multiplication, which is
irreversible: <em>K</em> = <em>k</em> × <em>G</em>, where <em>k</em> is the private key, <em>G</em> is a
constant point called the <em>generator point</em>, and <em>K</em> is the resulting
public key. The reverse operation, known as "finding the discrete
logarithm"—calculating <em>k</em> if you know <em>K</em>—is as difficult as trying
all possible values of <em>k</em> (i.e., a brute-force search). Before we
demonstrate how to generate a public key from a private key, let&#8217;s look
at elliptic curve cryptography in a bit more detail.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Elliptic curve multiplication is a type of function that cryptographers
call a "trap door" function: it is easy to do in one direction
(multiplication) and impossible to do in the reverse direction
(division). Someone with a private key can easily create the public
key and then share it with the world knowing that no one can reverse the
function and calculate the private key from the public key. This
mathematical trick becomes the basis for unforgeable and secure digital
signatures that prove control over bitcoin funds.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Starting with a private key in the
form of a randomly generated number <em>k</em>, we multiply it by a
predetermined point on the curve called the <em>generator point</em> <em>G</em> to
produce another point somewhere else on the curve, which is the
corresponding public key <em>K</em>. The generator point is specified as part
of the secp256k1 standard and is always the same for all keys in
bitcoin:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
{K = k \times G}
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>where <em>k</em> is the private key, <em>G</em> is the generator point, and <em>K</em> is the
resulting public key, a point on the curve. Because the generator point
is always the same for all Bitcoin users, a private key <em>k</em> multiplied
with <em>G</em> will always result in the same public key <em>K</em>. The relationship
between <em>k</em> and <em>K</em> is fixed but can only be calculated in one
direction, from <em>k</em> to <em>K</em>. That&#8217;s why a Bitcoin public key (<em>K</em>) can be
shared with anyone and does not reveal the user&#8217;s private key (<em>k</em>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>A private key can be converted into a public key, but a public key
cannot be converted back into a private key because the math only works
one way.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Implementing the elliptic curve multiplication, we take the private key
<em>k</em> generated previously and multiply it with the generator point <em>G</em> to
find the public key <em>K</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">K = 1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD × G</code></pre>
</div>
</div>
<div class="paragraph">
<p>Public key <em>K</em> is defined as a point <em>K</em> = (<em>x</em>, <em>y</em>):</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
K = (x, y)
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>where,</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x = F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341A
y = 07CF33DA18BD734C600B96A72BBC4749D5141C90EC8AC328AE52DDFE2E505BDB</pre>
</div>
</div>
<div class="paragraph">
<p>To visualize multiplication of a point with an integer, we will use the
simpler elliptic curve over real numbers&#x2014;remember, the math is
the same. Our goal is to find the multiple <em>kG</em> of the generator point
<em>G</em>, which is the same as adding <em>G</em> to itself, <em>k</em> times in a row. In
elliptic curves, adding a point to itself is the equivalent of drawing a
tangent line on the point and finding where it intersects the curve
again, then reflecting that point on the x-axis.</p>
</div>
<div class="paragraph">
<p><a href="#ecc_illustrated">Elliptic curve cryptography: visualizing the multiplication of a point G by an integer k on an elliptic curve.</a> shows the process for deriving <em>G</em>, <em>2G</em>, <em>4G</em>, as a
geometric operation on the curve.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Many Bitcoin implementations use
the <a href="https://oreil.ly/wD60m">libsecp256k1 cryptographic
library</a> to do the elliptic curve math.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="ecc_illustrated" class="imageblock">
<div class="content">
<img src="images/mbc3_0404.png" alt="ecc_illustrated">
</div>
<div class="title">Figure 4. Elliptic curve cryptography: visualizing the multiplication of a point G by an integer k on an elliptic curve.</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_output_and_input_scripts">Output and Input Scripts</h3>
<div class="paragraph">
<p>Although the illustration from the original Bitcoin paper, <a href="#pay-to-pure-pubkey">Transaction chain from original Bitcoin paper.</a>,
shows public keys (pubkeys) and signatures (sigs) being used directly,
the first version of Bitcoin instead had payments sent to a field called
<em>output script</em> and had spends of those bitcoins authorized by a field called <em>input script</em>.
These fields allow additional operations to be performed in addition to
(or instead of) verifying that a signature corresponds to a public key.
For example, an output script can contain two public keys and require two
corresponding signatures be placed in the spending input script.</p>
</div>
<div class="paragraph">
<p>Later, in <a href="#tx_script">[tx_script]</a>, we&#8217;ll learn about scripts in detail.  For now,
all we need to understand is that bitcoins are received to an
output script that acts like a public key, and bitcoin spending is
authorized by an input script that acts like a signature.</p>
</div>
</div>
<div class="sect2">
<h3 id="p2pk">IP Addresses: The Original Address for Bitcoin (P2PK)</h3>
<div class="paragraph">
<p>We&#8217;ve established that Alice can pay Bob by assigning some of her
bitcoins to one of Bob&#8217;s public keys.  But how does Alice get one of
Bob&#8217;s public keys?  Bob could just give her a copy, but let&#8217;s look again
at the public key we worked with in <a href="#public_key_derivation">Public Keys</a>.  Notice
that it&#8217;s quite long.  Imagine Bob trying to read that to Alice over the
phone:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x = F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341A
y = 07CF33DA18BD734C600B96A72BBC4749D5141C90EC8AC328AE52DDFE2E505BDB</pre>
</div>
</div>
<div class="paragraph">
<p>Instead of direct public key entry, the earliest version of Bitcoin
software allowed a spender to enter the receiver&#8217;s IP address, as shown in <a href="#bitcoin_01_send">Early send screen for Bitcoin via The Internet Archive.</a>.  This
feature was later removed&#8212;&#8203;there are many problems
with using IP addresses&#8212;&#8203;but a quick description of it will help us
better understand why certain features may have been added to the
Bitcoin protocol.</p>
</div>
<div id="bitcoin_01_send" class="imageblock">
<div class="content">
<img src="images/mbc3_0405.png" alt="Early Bitcoin send screen">
</div>
<div class="title">Figure 5. Early send screen for Bitcoin via <a href="https://oreil.ly/IDV1a">The Internet Archive</a>.</div>
</div>
<div class="paragraph">
<p>If Alice entered Bob&#8217;s IP address in Bitcoin 0.1, her full node would
establish a connection with his full node and receive a new public key
from Bob&#8217;s wallet that his node had never previously given anyone.  This
being a new public key was important to ensure that different
transactions paying Bob couldn&#8217;t be connected together by someone
looking at the blockchain and noticing that all of the transactions paid
the same public key.</p>
</div>
<div class="paragraph">
<p>Using the public key her node received from Bob&#8217;s node, Alice&#8217;s wallet
would construct a transaction output paying a very simple output script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;Bob's public key&gt; OP_CHECKSIG</pre>
</div>
</div>
<div class="paragraph">
<p>Bob would later be able to spend that output with an input script consisting
entirely of his signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;Bob's signature&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>To figure out what an output and input script are doing, you can
combine them together (input script first) and then note that each piece of
data (shown in angle brackets) is placed at the top of a list of items,
called a stack.  When an operation code (opcode) is encountered, it uses
items from the stack, starting with the topmost items.  Let&#8217;s look at
how that works by beginning with the combined script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;Bob's signature&gt; &lt;Bob's public key&gt; OP_CHECKSIG</pre>
</div>
</div>
<div class="paragraph">
<p>For this script, Bob&#8217;s signature is put on the stack, then Bob&#8217;s public
key is placed on top of it.  The OP_CHECKSIG operation consumes two
elements, starting with the public key and followed by the signature,
removing them from the stack.  It verifies the signature corresponds to
the public key and also commits to (signs) the various fields in the
transaction.  If the signature is correct, OP_CHECKSIG replaces itself
on the stack with the value 1; if the signature was not correct, it
replaces itself with a 0.  If there&#8217;s a nonzero item on top of the stack at the
end of evaluation, the script passes.  If all scripts in a transaction
pass, and all of the other details about the transaction are valid, then
full nodes will consider the transaction to be valid.</p>
</div>
<div class="paragraph">
<p>In short, the preceding script uses the same public key and signature
described in the original paper but adds in the complexity of two script
fields and an opcode.  That seems like extra work here, but we&#8217;ll begin
to see the benefits when we look at the following section.</p>
</div>
<div class="paragraph">
<p>This type of output is known today as <em>pay to public key</em>, or <em>P2PK</em> for
short.  It was never widely used for payments, and no widely used
program has supported IP address payments for almost a decade.</p>
</div>
</div>
<div class="sect2">
<h3 id="addresses_for_p2pkh">Legacy Addresses for P2PKH</h3>
<div class="paragraph">
<p>Entering the IP address of the person you want to pay has a number of
advantages, but it also has a number of downsides.  One particular
downside is that the receiver needs their wallet to be online at their
IP address, and it needs to be accessible from the outside world.  For
a lot of people, that isn&#8217;t an option.  They turn their computers off at
night, their laptops go to sleep, they&#8217;re behind firewalls, or they&#8217;re
using Network Address Translation (NAT).</p>
</div>
<div class="paragraph">
<p>This brings us back to the problem of receivers like Bob having to give
spenders like Alice a long public key.  The shortest version of Bitcoin
public keys known to the developers of early Bitcoin were 65 bytes, the
equivalent of 130 characters when written in hexadecimal.  However, Bitcoin
already contains several data structures much larger than 65 bytes
that need to be securely referenced in other parts of Bitcoin using the
smallest amount of data that was secure.</p>
</div>
<div class="paragraph">
<p>Bitcoin accomplishes that with a <em>hash function</em>, a function that takes
a potentially large amount of data, scrambles it (hashes it), and outputs a
fixed amount of data.  A cryptographic hash function will always produce
the same output when given the same input, and a secure function will
also make it impractical for somebody to choose a different input that
produces a previously-seen output.  That makes the output a <em>commitment</em>
to the input.  It&#8217;s a promise that, in practice, only input <em>x</em> will
produce output <em>X</em>.</p>
</div>
<div class="paragraph">
<p>For example, imagine I want to ask you a question and also give you my
answer in a form that you can&#8217;t read immediately.  Let&#8217;s say the
question is, "in what year did Satoshi Nakamoto start working on
Bitcoin?"  I&#8217;ll give you a commitment to my answer in the form of
output from the SHA256 hash function, the function most commonly used in
Bitcoin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>94d7a772612c8f2f2ec609d41f5bd3d04a5aa1dfe3582f04af517d396a302e4e</pre>
</div>
</div>
<div class="paragraph">
<p>Later, after you tell me your guess to the answer of the question, I can
reveal my answer and prove to you that my answer, as input to the hash
function, produces exactly the same output I gave you earlier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ echo "2007.  He said about a year and a half before Oct 2008" | sha256sum
94d7a772612c8f2f2ec609d41f5bd3d04a5aa1dfe3582f04af517d396a302e4e</pre>
</div>
</div>
<div class="paragraph">
<p>Now imagine that we ask Bob the question, "what is your public key?" Bob
can use a hash function to give us a cryptographically secure commitment
to his public key.  If he later reveals his key, and we verify it
produces the same commitment he previously gave us, we can be sure it
was the exact same key that was used to create that earlier commitment.</p>
</div>
<div class="paragraph">
<p>The SHA256 hash function is considered to be very secure and produces
256 bits (32 bytes) of output, less than half the size of original
Bitcoin public keys.  However, there are other slightly less secure hash
functions that produce smaller output, such as the RIPEMD-160 hash
function whose output is 160 bits (20 bytes).  For reasons Satoshi
Nakamoto never stated, the original version of Bitcoin made commitments
to public keys by first hashing the key with SHA256 and then hashing
that output with RIPEMD-160; this produced a 20-byte commitment to the
public key.</p>
</div>
<div class="paragraph less_space pagebreak-before">
<p>We can look at that algorithmically.
Starting with the public key <em>K</em>, we compute the SHA256 hash and then
compute the RIPEMD-160 hash of the result, producing a 160-bit (20-byte)
number:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
{A = RIPEMD160(SHA256(K))}
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>where <em>K</em> is the public key and <em>A</em> is the resulting commitment.</p>
</div>
<div class="paragraph">
<p>Now that we understand how to make a commitment to a public key, we need
to figure out how to use it in a transaction.  Consider the following
output script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>OP_DUP OP_HASH160 &lt;Bob's commitment&gt; OP_EQUAL OP_CHECKSIG</pre>
</div>
</div>
<div class="paragraph">
<p>And also the following input script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;Bob's signature&gt; &lt;Bob's public key&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Together, they form the following script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;sig&gt; &lt;pubkey&gt; OP_DUP OP_HASH160 &lt;commitment&gt; OP_EQUALVERIFY OP_CHECKSIG</pre>
</div>
</div>
<div class="paragraph">
<p>As we did in <a href="#p2pk">IP Addresses: The Original Address for Bitcoin (P2PK)</a>, we start putting items on the stack.  Bob&#8217;s
signature goes on first; his public key is then placed on top of the
stack.  The OP_DUP operation duplicates the top item, so the top and
second-to-top item on the stack are now both Bob&#8217;s public key.  The
OP_HASH160 operation consumes (removes) the top public key and
replaces it with the result of hashing it with RIPEMD160(SHA256(K)),
so now the top of the stack is a hash of Bob&#8217;s public key.  Next, the
commitment to Bob&#8217;s public key is added to the top of the stack.  The
OP_EQUALVERIFY operation consumes the top two items and verifies that
they are equal; that should be the case if the public key Bob provided
in the input script is the same public key used to create the commitment in
the output script that Alice paid.  If OP_EQUALVERIFY fails, the whole
script fails.  Finally, we&#8217;re left with a stack containing just Bob&#8217;s
signature and his public key; the OP_CHECKSIG opcode verifies they
correspond with each other and that the signature commits to the
transaction.</p>
</div>
<div class="paragraph">
<p>Although this process of paying to a public key hash (<em>P2PKH</em>) may seem
convoluted, it allows Alice&#8217;s payment to
Bob to contain only a 20 byte commitment to his public key instead of
the key itself, which would&#8217;ve been 65 bytes in the original version of
Bitcoin.  That&#8217;s a lot less data for Bob to have to communicate to
Alice.</p>
</div>
<div class="paragraph">
<p>However, we haven&#8217;t yet discussed how Bob gets those 20 bytes from his
Bitcoin wallet to Alice&#8217;s wallet.  There are commonly used encodings for
byte values, such as hexadecimal, but any mistake made in copying a
commitment would result in the bitcoins being sent to an unspendable
output, causing them to be lost forever.  In the next section, we&#8217;ll
look at compact encoding and reliable checksums.</p>
</div>
</div>
<div class="sect2">
<h3 id="base58">Base58check Encoding</h3>
<div class="paragraph">
<p>In order to represent long numbers in a compact way,
using fewer symbols, many computer systems use mixed-alphanumeric
representations with a base (or radix) higher than 10. For example,
whereas the traditional decimal system uses 10 numerals, 0 through 9,
the hexadecimal system uses 16, with the letters A through F as the six
additional symbols. A number represented in hexadecimal format is
shorter than the equivalent decimal representation. Even more compact,
base64 representation uses 26 lowercase letters, 26 capital letters, 10
numerals, and 2 more characters such as "+" and "/" to
transmit binary data over text-based media such as email.</p>
</div>
<div class="paragraph">
<p>Base58 is a similar encoding to
base64, using upper- and lowercase letters and numbers,
but omitting some characters that are frequently mistaken for one
another and can appear identical when displayed in certain fonts.
Specifically, base58 is base64 without the 0 (number zero), O (capital
o), l (lower L), I (capital i), and the symbols "+" and
"/." Or, more simply, it is a set of lowercase and capital letters and
numbers without the four (0, O, l, I) just mentioned. <a href="#base58alphabet">Bitcoin&#8217;s base58 alphabet</a>
shows the full base58 alphabet.</p>
</div>
<div id="base58alphabet" class="exampleblock">
<div class="title">Example 2. Bitcoin&#8217;s base58 alphabet</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre>123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To add extra security against typos or transcription errors, base58check
includes a <em>checksum</em> encoded in the base58 alphabet. The checksum is an
additional four bytes
added to the end of the data that is being encoded. The checksum is
derived from the hash of the encoded data and can therefore be used to
detect transcription and typing errors. When presented with
base58check code, the decoding software will calculate the checksum of
the data and compare it to the checksum included in the code. If the two
do not match, an error has been introduced and the base58check data is
invalid. This prevents a mistyped Bitcoin address from being accepted by
the wallet software as a valid destination, an error that would
otherwise result in loss of funds.</p>
</div>
<div class="paragraph">
<p>To convert data (a number) into a base58check format, we first add a
prefix to the data, called the "version byte," which serves to easily
identify the type of data that is encoded. For example, the prefix zero
(0x00 in hex) indicates that the data should be used as the commitment (hash) in
a legacy P2PKH output script.  A list of common version prefixes is shown
in <a href="#base58check_versions">[base58check_versions]</a>.</p>
</div>
<div class="paragraph">
<p>Next, we compute the "double-SHA" checksum, meaning we apply the SHA256
hash-algorithm twice on the previous result (the prefix concatenated
with the data):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>checksum = SHA256(SHA256(prefix||data))</pre>
</div>
</div>
<div class="paragraph">
<p>From the resulting 32-byte hash (hash-of-a-hash), we take only the first
four bytes. These four bytes serve as the error-checking code, or
checksum. The checksum is appended to the end.</p>
</div>
<div class="paragraph">
<p>The result is composed of three items: a prefix, the data, and a
checksum. This result is encoded using the base58 alphabet described
previously. <a href="#base58check_encoding">Base58check encoding: a base58, versioned, and checksummed format for unambiguously encoding bitcoin data.</a> illustrates the base58check
encoding process.</p>
</div>
<div id="base58check_encoding" class="imageblock">
<div class="content">
<img src="images/mbc3_0406.png" alt="Base58checkEncoding">
</div>
<div class="title">Figure 6. Base58check encoding: a base58, versioned, and checksummed format for unambiguously encoding bitcoin data.</div>
</div>
<p class="fix_tracking2">
In Bitcoin, other data besides public key commitments are presented to the user in
base58check encoding to make that data compact, easy to read, and easy to detect
errors. The version prefix in base58check encoding is used to create
easily distinguishable formats, which when encoded in base58 contain
specific characters at the beginning of the base58check-encoded payload.
These characters make it easy for humans to identify the type of data
that is encoded and how to use it. This is what differentiates, for
example, a base58check-encoded Bitcoin address that starts with a 1 from
a base58check-encoded private key wallet import format (WIF) that starts with a 5. Some example
version prefixes and the resulting base58 characters are shown in
<a data-type="xref" href="#base58check_versions">#base58check_versions</a>.
</p>
<table id="base58check_versions">
<caption>Base58check version prefix and encoded result examples</caption>
<thead>
<tr>
<th>Type</th>
<th>Version prefix (hex)</th>
<th>Base58 result prefix</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>Address for pay to public key hash (P2PKH)</p></td>
<td><p>0x00</p></td>
<td><p>1</p></td>
</tr>
<tr>
<td><p>Address for pay to script hash (P2SH)</p></td>
<td><p>0x05</p></td>
<td><p>3</p></td>
</tr>
<tr>
<td><p>Testnet Address for P2PKH</p></td>
<td><p>0x6F</p></td>
<td><p>m or n</p></td>
</tr>
<tr>
<td><p>Testnet Address for P2SH</p></td>
<td><p>0xC4</p></td>
<td><p>2</p></td>
</tr>
<tr>
<td><p>Private Key WIF</p></td>
<td><p>0x80</p></td>
<td><p>5, K, or L</p></td>
</tr>
<tr>
<td><p>BIP32 Extended Public Key</p></td>
<td><p>0x0488B21E</p></td>
<td><p>xpub</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Combining public keys, hash-based commitments, and base58check
encoding, <a href="#pubkey_to_address">Public key to Bitcoin address: conversion of a public key to a Bitcoin address.</a> illustrates the conversion of a public key
into a Bitcoin address.</p>
</div>
<div id="pubkey_to_address" class="imageblock">
<div class="content">
<img src="images/mbc3_0407.png" alt="pubkey_to_address">
</div>
<div class="title">Figure 7. Public key to Bitcoin address: conversion of a public key to a Bitcoin address.</div>
</div>
</div>
<div class="sect2">
<h3 id="comp_pub">Compressed Public Keys</h3>
<div class="paragraph">
<p>When Bitcoin was first authored, its developers only knew how to create
65-byte public keys.  However, a later developer became aware of an
alternative encoding for public keys that used only 33 bytes and which
was backward compatible with all Bitcoin full nodes at the time,
so there was no need to change the Bitcoin protocol.  Those 33-byte
public keys are known as <em>compressed public keys</em>, and the original 65-byte keys are known as <em>uncompressed public keys</em>.  Using smaller public keys
results in smaller transactions, allowing more payments to be made in the same
block.</p>
</div>
<div class="paragraph">
<p>As we saw in the section <a href="#public_key_derivation">Public Keys</a>, a public key is a point <span class="keep-together">(x, y)</span> on an
elliptic curve. Because the curve expresses a mathematical function, a
point on the curve represents a solution to the equation and, therefore,
if we know the <em>x</em> coordinate, we can calculate the <em>y</em> coordinate by
solving the equation <span class="keep-together">y<sup>2</sup> mod p = (x<sup>3</sup> + 7) mod p.</span> That allows us to
store only the <em>x</em> coordinate of the public key point, omitting the <em>y</em>
coordinate and reducing the size of the key and the space required to
store it by 256 bits. An almost 50% reduction in size in every
transaction adds up to a lot of data saved over time!</p>
</div>
<div class="paragraph">
<p>Here is the public key generated by the private key we created in
<a href="#public_key_derivation">Public Keys</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x = F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341A
y = 07CF33DA18BD734C600B96A72BBC4749D5141C90EC8AC328AE52DDFE2E505BDB</pre>
</div>
</div>
<div class="paragraph">
<p>Here&#8217;s the same public key shown as a 520-bit number (130 hex digits)
with the prefix 04 followed by x and then y coordinates, as 04 x
y:</p>
</div>
<pre data-type="programlisting">
K = 04F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341A\
    07CF33DA18BD734C600B96A72BBC4749D5141C90EC8AC328AE52DDFE2E505BDB
</pre>
<div class="paragraph">
<p>Whereas uncompressed public keys have a prefix of 04, compressed
public keys start with either a 02 or a 03 prefix. Let&#8217;s look at why
there are two possible prefixes: because the left side of the equation
is <em>y</em><sup>2</sup>, the solution for <em>y</em> is a square root, which can have a
positive or negative value. Visually, this means that the resulting <em>y</em>
coordinate can be above or below the x-axis. As you can see from the
graph of the elliptic curve in <a href="#ecc-curve">An elliptic curve.</a>, the curve is symmetric,
meaning it is reflected like a mirror by the x-axis. So, while we can
omit the <em>y</em> coordinate, we have to store the <em>sign</em> of <em>y</em> (positive or
negative); in other words, we have to remember if it was above or
below the x-axis because each of those options represents a different
point and a different public key. When calculating the elliptic curve in
binary arithmetic on the finite field of prime order p, the <em>y</em>
coordinate is either even or odd, which corresponds to the
positive/negative sign as explained earlier. Therefore, to distinguish
between the two possible values of <em>y</em>, we store a compressed public key
with the prefix 02 if the <em>y</em> is even, and 03 if it is odd, allowing
the software to correctly deduce the <em>y</em> coordinate from the <em>x</em>
coordinate and uncompress the public key to the full coordinates of the
point. Public key compression is illustrated in <a href="#pubkey_compression">Public key compression.</a>.</p>
</div>
<div id="pubkey_compression" class="imageblock">
<div class="content">
<img src="images/mbc3_0408.png" alt="pubkey_compression">
</div>
<div class="title">Figure 8. Public key compression.</div>
</div>
<div class="paragraph">
<p>Here&#8217;s the same public key generated in <a href="#public_key_derivation">Public Keys</a>, shown as a compressed
public key stored in 264 bits (66 hex digits) with the prefix 03
indicating the <em>y</em> coordinate is odd:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>K = 03F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341A</pre>
</div>
</div>
<div class="paragraph">
<p>This compressed public key corresponds to the same private key, meaning
it is generated from the same private key. However, it looks different
from the uncompressed public key. More importantly, if we convert this
compressed public key to a commitment using the HASH160
function (RIPEMD160(SHA256(K))), it will produce a <em>different</em>
commitment than the uncompressed public key, leading to a different
address. This can be confusing because it means that a single private
key can produce a public key expressed in two different formats
(compressed and uncompressed) that produce two different Bitcoin
addresses. However, the private key is identical for both Bitcoin
addresses.</p>
</div>
<div class="paragraph">
<p>Compressed public keys are now the default in almost all Bitcoin
software and were required when using certain new features added
in later protocol upgrades.</p>
</div>
<div class="paragraph">
<p>However, some software still needs to support uncompressed public keys,
such as a wallet application importing private keys from an older
wallet.  When the new wallet scans the blockchain for old P2PKH outputs
and inputs, it needs to know whether to scan the 65-byte keys (and
commitments to those keys) or 33-byte keys (and their commitments).  Failure
to scan for the correct type can lead to the user not being able to
spend their full balance.  To resolve this issue, when private keys are
exported from a wallet, the WIF that is used to
represent them is implemented slightly differently in newer Bitcoin
wallets to indicate that these private keys have been used to produce
compressed public keys.</p>
</div>
</div>
<div class="sect2">
<h3 id="addresses_for_p2sh">Legacy Pay to Script Hash (P2SH)</h3>
<div class="paragraph">
<p>As we&#8217;ve seen in preceding sections, someone receiving bitcoins (like
Bob) can require that payments to him contain certain constraints in their
output script.  Bob will need to fulfill those constraints using an
input script when he spends those bitcoins.  In <a href="#p2pk">IP Addresses: The Original Address for Bitcoin (P2PK)</a>, the constraint
was simply that the input script needed to provide an appropriate
signature.  In <a href="#addresses_for_p2pkh">Legacy Addresses for P2PKH</a>, an appropriate public key also needed to be
provided.</p>
</div>
<p class="fix_tracking3">
For a spender (like Alice) to place the constraints Bob wants
in the output script she uses to pay him, Bob needs to communicate those
constraints to her.  This is similar to the problem of Bob needing to
communicate his public key to her.  Like that problem, where
public keys can be fairly large, the constraints Bob uses can also be
quite large—potentially thousands of bytes.  That's not only thousands
of bytes that need to be communicated to Alice, but thousands of bytes
for which she needs to pay transaction fees every time she wants to spend money to Bob.  However, the solution of using hash functions to create
small commitments to large amounts of data also applies here.
</p>
<div class="paragraph">
<p>The BIP16 upgrade to the Bitcoin protocol in 2012 allows an
output script to commit to a <em>redemption script</em> (<em>redeem script</em>).  When
Bob spends his bitcoins, his input script needs to provide a redeem script
that matches the commitment and also any data necessary to satisfy the
redeem script (such as signatures).  Let&#8217;s start by imagining Bob wants
to require two signatures to spend his bitcoins, one signature from his
desktop wallet and one from a hardware signing device.  He puts those
conditions into a redeem script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;public key 1&gt; OP_CHECKSIGVERIFY &lt;public key 2&gt; OP_CHECKSIG</pre>
</div>
</div>
<div class="paragraph">
<p>He then creates a commitment to the redeem script using the same
HASH160 mechanism used for P2PKH commitments, RIPEMD160(SHA256(script)).
That commitment is placed into the output script using a special
template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>OP_HASH160 &lt;commitment&gt; OP_EQUAL</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>When using pay to script hash (P2SH), you must use the specific P2SH template
with no extra data or conditions in the output script.  If the
output script is not exactly OP_HASH160 &lt;20 bytes&gt; OP_EQUAL, the
redeem script will not be used and any bitcoins may either be unspendable
or spendable by anyone (meaning anyone can take them).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When Bob goes to spend the payment he received to the commitment for his
script, he uses an input script that includes the redeem script, with it
serialized as a single data element.  He also provides the signatures
he needs to satisfy the redeem script, putting them in the order that
they will be consumed by the opcodes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;signature2&gt; &lt;signature1&gt; &lt;redeem script&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>When Bitcoin full nodes receive Bob&#8217;s spend, they&#8217;ll verify that the
serialized redeem script will hash to the same value as the commitment.
Then they&#8217;ll replace it on the stack with its deserialized value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;signature2&gt; &lt;signature1&gt; &lt;pubkey1&gt; OP_CHECKSIGVERIFY &lt;pubkey2&gt; OP_CHECKSIG</pre>
</div>
</div>
<div class="paragraph">
<p>The script is executed and, if it passes and all of the other
transaction details are correct, the transaction is valid.</p>
</div>
<div class="paragraph">
<p>Addresses for P2SH are also created with
base58check.  The version prefix is set to 5, which results in an
encoded address starting with a 3. An example of a P2SH address is
3F6i6kwkevjR7AsAd4te2YB2zZyASEm1HM.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>P2SH is not necessarily the same as a multisignature
transaction. A P2SH address <em>most often</em> represents a multisignature
script, but it might also represent a script encoding other types of
transactions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>P2PKH and P2SH are the only two script templates used with base58check
encoding.  They are now known as legacy addresses and have become less
common over time.
Legacy addresses were supplanted by the bech32 family of addresses.</p>
</div>
<div id="p2sh_collision_attacks" class="sidebarblock">
<div class="content">
<div class="title">P2SH Collision Attacks</div>
<div class="paragraph">
<p>All addresses based on hash functions are theoretically vulnerable to an
attacker independently finding the same input that produced the hash
function output (commitment).  In the case of Bitcoin, if they find the
input the same way the original user did, they&#8217;ll know the user&#8217;s private
key and be able to spend that user&#8217;s bitcoins.  The chance of an attacker
independently generating the input for an existing commitment is
proportional to the strength of the hash algorithm.  For a secure
160-bit algorithm like HASH160, the probability is 1-in-2<sup>160</sup>.  This is
a <em>preimage attack</em>.</p>
</div>
<div class="paragraph">
<p>An attacker can also try to generate two different inputs (e.g., redeem
scripts) that produce the same commitment.  For addresses created
entirely by a single party, the chance of an attacker generating a
different input for an existing commitment is also about 1-in-2<sup>160</sup> for
the HASH160 algorithm.  This is a <em>second preimage attack</em>.</p>
</div>
<div class="paragraph">
<p>However, this changes when an attacker is able to influence the original input
value. For example, an attacker participates in the creation of a
multisignature script where they don&#8217;t need to submit their public key until after they learn all of the other partys' public keys.
In that case, the strength of hash algorithm is reduced to its square
root.  For HASH160, the probability becomes 1-in-2<sup>80</sup>.  This is a
<em>collision attack</em>.</p>
</div>
<div class="paragraph">
<p>To put those numbers in context, as of early 2023, all Bitcoin miners
combined execute about 2<sup>80</sup> hash functions every hour.  They run a
different hash function than HASH160, so their existing hardware can&#8217;t
create collision attacks for it, but the existence of the Bitcoin
network proves that collision attacks against 160-bit functions like
HASH160 are practical.  Bitcoin miners have spent the equivalent of
billions of US dollars on special hardware, so creating a collision
attack wouldn&#8217;t be cheap, but there are organizations that expect to
receive billions of dollars in bitcoins to addresses generated by
processes involving multiple parties, which could make the attack
profitable.</p>
</div>
<div class="paragraph">
<p>There are well-established cryptographic protocols for preventing
collision attacks, but a simple solution that doesn&#8217;t require any
special knowledge on the part of wallet developers is to simply use
a stronger hash function.  Later upgrades to Bitcoin made that possible,
and newer Bitcoin addresses provide at least 128 bits of collision
resistance.  To perform 2<sup>128</sup> hash operations would take all current
Bitcoin miners about 32 billion years.</p>
</div>
<div class="paragraph">
<p>Although we do not believe there is any immediate threat to anyone
creating new P2SH addresses, we recommend all new wallets use newer
types of addresses to eliminate address collision attacks as a concern.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bech32_addresses">Bech32 Addresses</h3>
<div class="paragraph">
<p>In 2017, the Bitcoin protocol was upgraded.  When the upgrade is used,
it prevents transaction
identifiers (txids) from being changed without the consent of a spending
user (or a quorum of signers when multiple signatures are required).
The upgrade, called <em>segregated witness</em> (or <em>segwit</em> for short),  also
provided additional capacity for transaction data in blocks and several
other benefits.  However, users wanting direct access to segwit&#8217;s
benefits had to accept payments to new output scripts.</p>
</div>
<div class="paragraph">
<p>As mentioned in <a href="#p2sh">[p2sh]</a>, one of the advantages of the P2SH output type
was that a spender (such as Alice) didn&#8217;t need to know the details of
the script the receiver (such as Bob) used.  The segwit upgrade was
designed to use this mechanism, allowing users to
immediately begin accessing many of the new benefits by using a P2SH
address.  But for Bob to gain access to all of the benefits, he would
need Alice&#8217;s wallet to pay him using a different type of script.  That
would require Alice&#8217;s wallet to upgrade to support the new scripts.</p>
</div>
<div class="paragraph">
<p>At first, Bitcoin developers proposed BIP142, which would continue using
base58check with a new version byte, similar to the P2SH upgrade.  But
getting all wallets to upgrade to new scripts with a new base58check
version was expected to require almost as much work as getting them to
upgrade to an entirely new address format, so several Bitcoin
contributors set out to design the best possible address format.  They
identified several problems with base58check:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Its mixed-case presentation made it inconvenient to read aloud or
transcribe.  Try reading one of the legacy addresses in this chapter
to a friend who you have transcribe it.  Notice how you have to prefix
every letter with the words "uppercase" and "lowercase."  Also, note
when you review their writing that the uppercase and lowercase
versions of some letters can look similar in many people&#8217;s
handwriting.</p>
</li>
<li>
<p>It can detect errors, but it can&#8217;t help users correct those errors.
For example, if you accidentally transpose two characters when manually
entering an address, your wallet will almost certainly warn that a
mistake exists, but it won&#8217;t help you figure out where the error is
located.  It might take you several frustrating minutes to eventually
discover the mistake.</p>
</li>
<li>
<p>A mixed-case alphabet also requires extra space to encode in QR codes,
which are commonly used to share addresses and invoices
between wallets.  That extra space means QR codes need to be larger at
the same resolution or they become harder to scan quickly.</p>
</li>
</ul>
</div>
<div class="ulist less_space pagebreak-before">
<ul>
<li>
<p>It requires every spender wallet upgrade to support new protocol
features like P2SH and segwit.  Although the upgrades themselves might
not require much code, experience shows that many wallet authors are
busy with other work and can sometimes delay upgrading for years.
This adversely affects everyone who wants to use the new features.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The developers working on an address format for segwit found solutions
for each of these problems in a new address format called
bech32 (pronounced with a soft "ch", as in "besh thirty-two").  The
"bech" stands for BCH, the initials of the three individuals who
discovered the cyclic code in 1959 and 1960 upon which bech32 is based.
The "32" stands for the number of characters in the bech32 alphabet
(similar to the 58 in base58check):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bech32 uses only numbers and a single case of letters (preferably
rendered in lowercase).  Despite its alphabet being almost half the
size of the base58check alphabet, a bech32 address for a pay to witness public key hash (P2WPKH) script
is only slightly longer than a legacy address for an equivalent P2PKH
script.</p>
</li>
<li>
<p>Bech32 can both detect and help correct errors.  In an address of an
expected length, it is mathematically guaranteed to detect any error
affecting four characters or less; that&#8217;s more reliable than
base58check.  For longer errors, it will fail to detect them less than
one time in a billion, which is roughly the same reliability as
base58check.  Even better, for an address typed with just a few
errors, it can tell the user where those errors occurred, allowing them to
quickly correct minor transcription mistakes.  See <a href="#bech32_typo_detection">Bech32 typo detection</a>
for an example of an address entered with errors.</p>
<div id="bech32_typo_detection" class="exampleblock">
<div class="title">Example 3. Bech32 typo detection</div>
<div class="content">
<div class="paragraph">
<p>Address:
  bc1p9nh05ha8wrljf7ru236aw<u><strong>n</strong></u>4t2x0d5ctkkywm<u><strong>v</strong></u>9sclnm4t0av2vgs4k3au7</p>
</div>
<div class="paragraph">
<p>Detected errors shown in bold and underlined.  Generated using the
<a href="https://oreil.ly/paWIx">bech32 address decoder demo</a>.</p>
</div>
</div>
</div>
</li>
<li>
<p>Bech32 is preferably written with only lowercase characters, but those
lowercase characters can be replaced with uppercase characters before
encoding an address in a QR code.  This allows the use of a special QR
encoding mode that uses less space.  Notice the difference in size and
complexity of the two QR codes for the same address in
<a href="#bech32_qrcode_uc_lc">The same bech32 address QR encoded in lowercase and uppercase.</a>.</p>
<div id="bech32_qrcode_uc_lc" class="imageblock">
<div class="content">
<img src="images/mbc3_0409.png" alt="The same bech32 address QR encoded in lowercase and uppercase">
</div>
<div class="title">Figure 9. The same bech32 address QR encoded in lowercase and uppercase.</div>
</div>
</li>
<li>
<p>Bech32 takes advantage of an upgrade mechanism designed as part of
segwit to make it possible for spender wallets to be able to pay
output types that aren&#8217;t in use yet.  The goal was to allow developers
to build a wallet today that allows spending to a bech32 address
and have that wallet remain able to spend to bech32 addresses for
users of new features added in future protocol upgrades.  It was
hoped that we might never again need to go through the system-wide
upgrade cycles necessary to allow people to fully use P2SH and segwit.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_problems_with_bech32_addresses">Problems with Bech32 Addresses</h4>
<div class="paragraph">
<p>Bech32 addresses would have been a success in every area except for one
problem.  The mathematical guarantees about their ability to detect
errors only apply if the length of the address you enter into a wallet
is the same length of the original address.  If you add or remove any
characters during transcription, the guarantee doesn&#8217;t apply and your
wallet may spend funds to a wrong address.  However, even without the
guarantee, it was thought that it would be very unlikely that a user adding
or removing characters would produce a string with a valid checksum, ensuring
users' funds were safe.</p>
</div>
<div class="paragraph">
<p>Unfortunately, the choice for one of the constants in the bech32
algorithm just happened to make it very easy to add or remove the letter
"q" in the penultimate position of an address that ends with the letter
"p."  In those cases, you can also add or remove the letter "q" multiple
times.  This will be caught by the checksum some of the time, but it
will be missed far more often than the one-in-a-billion expectations for
bech32&#8217;s substitution errors.  For an example, see <a href="#bech32_length_extension_example">Extending the length of bech32 address without invalidating its checksum</a>.</p>
</div>
<div id="bech32_length_extension_example" class="exampleblock less_space pagebreak-before">
<div class="title">Example 4. Extending the length of bech32 address without invalidating its checksum</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre>Intended bech32 address:
bc1pqqqsq9txsqp

Incorrect addresses with a valid checksum:
bc1pqqqsq9txsqqqqp
bc1pqqqsq9txsqqqqqqp
bc1pqqqsq9txsqqqqqqqqp
bc1pqqqsq9txsqqqqqqqqqp
bc1pqqqsq9txsqqqqqqqqqqqp</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For the initial version of segwit (version 0), this wasn&#8217;t a practical
concern.  Only two valid lengths were defined for v0 segwit outputs: 22
bytes and 34 bytes.  Those correspond to bech32 addresses that are 42 characters
or 62 characters long, so someone would need to add or remove the letter "q"
from the penultimate position of a bech32 address 20 times in order to
send money to an invalid address without a wallet being able to detect
it.  However, it would become a problem for users in the future if
a segwit-based upgrade were ever to be implemented.</p>
</div>
</div>
<div class="sect3">
<h4 id="_bech32m">Bech32m</h4>
<div class="paragraph">
<p>Although bech32 worked well for segwit v0, developers didn&#8217;t want to
unnecessarily constrain output sizes in later versions of segwit.
Without constraints, adding or removing a single "q" in a bech32 address
could result in a user accidentally sending their money to an
output that was either unspendable or spendable by anyone (allowing
those bitcoins to be taken by anyone).  Developers exhaustively analyzed the bech32
problem and found that changing a single constant in their algorithm
would eliminate the problem, ensuring that any insertion or deletion of
up to five characters will only fail to be detected less often than one
time in a billion.</p>
</div>
<div class="paragraph">
<p>The version of bech32 with a single different constant is known as
bech32 modified (bech32m).  All of the characters in bech32 and bech32m
addresses for the same underlying data will be identical except for the
last six (the checksum).  That means a wallet will need to know which
version is in use in order to validate the checksum, but both address
types contain an internal version byte that makes determining that easy.</p>
</div>
<div class="paragraph">
<p>To work with both bech32 and bech32m, we&#8217;ll look at the encoding and parsing rules for
bech32m Bitcoin addresses since they encompass the ability to parse
bech32 addresses and are the current recommended address format for
Bitcoin wallets.</p>
</div>
<div class="paragraph">
<p>Bech32m addresses start with a human readable part (HRP).  There are
rules in BIP173 for creating your own HRPs, but for Bitcoin you only
need to know about the HRPs already chosen, shown in
<a href="#bech32_hrps_for_bitcoin">[bech32_hrps_for_bitcoin]</a>.</p>
</div>
<table id="bech32_hrps_for_bitcoin">
<caption>Bech32 HRPs for Bitcoin</caption>
<thead>
<tr>
<th>HRPs</th>
<th>Network</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>bc</p></td>
<td><p>Bitcoin mainnet</p></td>
</tr>
<tr>
<td><p>tb</p></td>
<td><p>Bitcoin testnet</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The HRP is followed by a separator, the number "1."  Earlier proposals
for a protocol separator used a colon but some operating systems and
applications that allow a user to double-click a word to highlight
it for copy and pasting won&#8217;t extend the highlighting to and past a
colon.  A number ensured double-click highlighting would work with any
program that supports bech32m strings in general (which include other
numbers).  The number "1" was chosen because bech32 strings don&#8217;t
otherwise use it in order to prevent accidental transliteration between
the number "1" and the lowercase letter "l."</p>
</div>
<div class="paragraph">
<p>The other part of a bech32m address is called the "data part."  There
are three elements to this part:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Witness version</dt>
<dd>
<p>A single byte that encodes as a single character
in a bech32m Bitcoin address immediately following the separator.
This letter represents the segwit version.  The letter "q" is the
encoding of "0" for segwit v0, the initial version of segwit where
bech32 addresses were introduced.  The letter "p" is the encoding of
"1" for segwit v1 (also called taproot) where bech32m began to be
used.  There are seventeen possible versions of segwit and it&#8217;s
required for Bitcoin that the first byte of a bech32m data part decode
to the number 0 through 16 (inclusive).</p>
</dd>
<dt class="hdlist1">Witness program</dt>
<dd>
<p>From 2 to 40 bytes.  For segwit v0, this witness program
must be either 20 or 32 bytes; no other length is valid.  For segwit
v1, the only defined length as of this writing is 32 bytes but other
lengths may be defined later.</p>
</dd>
<dt class="hdlist1">Checksum</dt>
<dd>
<p>Exactly 6 characters.  This is created using a BCH code, a type of
error correction code (although for Bitcoin addresses, we&#8217;ll see later
that it&#8217;s essential to use the checksum only for error detection&#8212;&#8203;not
correction).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Let&#8217;s illustrate these rules by walking through an example of creating
bech32 and bech32m addresses.  For all of the following examples, we&#8217;ll use the
<a href="https://oreil.ly/gpTT6">bech32m reference code
for Python</a>.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll start by generating four output scripts, one for each of the
different segwit outputs in use at the time of publication, plus one for
a future segwit version that doesn&#8217;t yet have a defined meaning.  The
scripts are listed in <a href="#scripts_for_diff_segwit_outputs">[scripts_for_diff_segwit_outputs]</a>.</p>
</div>
<table id="scripts_for_diff_segwit_outputs">
<caption>Scripts for different types of segwit outputs</caption>
<thead>
<tr>
<th>Output type</th>
<th>Example script</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>P2WPKH</p></td>
<td><p><code>OP_0 2b626ed108ad00a944bb2922a309844611d25468</code></p></td>
</tr>
<tr>
<td><p>P2WSH</p></td>
<td><p><code>OP_0 648a32e50b6fb7c5233b228f60a6a2ca4158400268844c4bc295ed5e8c3d626f</code></p></td>
</tr>
<tr>
<td><p>P2TR</p></td>
<td><p><code>OP_1 2ceefa5fa770ff24f87c5475d76eab519eda6176b11dbe1618fcf755bfac5311</code></p></td>
</tr>
<tr>
<td><p>Future Example</p></td>
<td><p><code>OP_16 0000</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For the P2WPKH output, the witness program contains a commitment constructed in exactly the same
way as the commitment for a P2PKH output seen in <a href="#addresses_for_p2pkh">Legacy Addresses for P2PKH</a>.  A public key is passed into a SHA256 hash
function.  The resultant 32-byte digest is then passed into a RIPEMD-160
hash function.  The digest of that function (the commitment) is placed
in the witness program.</p>
</div>
<div class="paragraph">
<p>For the pay to witness script hash (P2WSH) output, we don&#8217;t use the P2SH algorithm.  Instead we take
the script, pass it into a SHA256 hash function, and use the 32-byte
digest of that function in the witness program.  For P2SH, the SHA256
digest was hashed again with RIPEMD-160, but that may not be secure in
some cases; for details, see <a href="#p2sh_collision_attacks">P2SH Collision Attacks</a>.  A result of
using SHA256 without RIPEMD-160 is that P2WSH commitments are 32 bytes
(256 bits) instead of 20 bytes (160 bits).</p>
</div>
<div class="paragraph">
<p>For the pay-to-taproot (P2TR) output, the witness program is a point on
the secp256k1 curve.  It may be a simple public key, but in most cases
it should be a public key that commits to some additional data.  We&#8217;ll
learn more about that commitment in <a href="#taproot">[taproot]</a>.</p>
</div>
<p class="fix_tracking2">
For the example of a future segwit version, we simply use the highest
possible segwit version number (16) and the smallest allowed witness
program (2 bytes) with a null value.</p>
<div class="paragraph">
<p>Now that we know the version number and the witness program, we can
convert each of them into a bech32 address.  Let&#8217;s use the bech32m reference
library for Python to quickly generate those addresses, and then take a
deeper look at what&#8217;s happening:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ github="https://raw.githubusercontent.com"
$ wget $github/sipa/bech32/master/ref/python/segwit_addr.py

$ python
&gt;&gt;&gt; from segwit_addr import *
&gt;&gt;&gt; from binascii import unhexlify

&gt;&gt;&gt; help(encode)
encode(hrp, witver, witprog)
    Encode a segwit address.

&gt;&gt;&gt; encode('bc', 0, unhexlify('2b626ed108ad00a944bb2922a309844611d25468'))
'bc1q9d3xa5gg45q2j39m9y32xzvygcgay4rgc6aaee'
&gt;&gt;&gt; encode('bc', 0,
unhexlify('648a32e50b6fb7c5233b228f60a6a2ca4158400268844c4bc295ed5e8c3d626f'))
'bc1qvj9r9egtd7mu2gemy28kpf4zefq4ssqzdzzycj7zjhk4arpavfhsct5a3p'
&gt;&gt;&gt; encode('bc', 1,
unhexlify('2ceefa5fa770ff24f87c5475d76eab519eda6176b11dbe1618fcf755bfac5311'))
'bc1p9nh05ha8wrljf7ru236awm4t2x0d5ctkkywmu9sclnm4t0av2vgs4k3au7'
&gt;&gt;&gt; encode('bc', 16, unhexlify('0000'))
'bc1sqqqqkfw08p'</pre>
</div>
</div>
<div class="paragraph">
<p>If we open the file <em>segwit_addr.py</em> and look at what the code is doing,
the first thing we will notice
is the sole difference between bech32 (used for segwit v0) and bech32m
(used for later segwit versions) is the constant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>BECH32_CONSTANT = 1
BECH32M_CONSTANT = 0x2bc830a3</pre>
</div>
</div>
<div class="paragraph">
<p>Next we notice the code that produces the checksum.  In the final step of the
checksum, the appropriate constant is merged into the value using an xor
operation.  That single value is the only difference between bech32 and
bech32m.</p>
</div>
<div class="paragraph">
<p>With the checksum created, each 5-bit character in the data part
(including the witness version, witness program, and checksum) is
converted to alphanumeric characters.</p>
</div>
<div class="paragraph">
<p>For decoding back into an output script, we work in reverse.  First let&#8217;s
use the reference library to decode two of our addresses:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; help(decode)
decode(hrp, addr)
    Decode a segwit address.

&gt;&gt;&gt; _ = decode("bc", "bc1q9d3xa5gg45q2j39m9y32xzvygcgay4rgc6aaee")
&gt;&gt;&gt;  _[0], bytes(_[1]).hex()
(0, '2b626ed108ad00a944bb2922a309844611d25468')
&gt;&gt;&gt; _ = decode("bc",
        "bc1p9nh05ha8wrljf7ru236awm4t2x0d5ctkkywmu9sclnm4t0av2vgs4k3au7")
&gt;&gt;&gt; _[0], bytes(_[1]).hex()
(1, '2ceefa5fa770ff24f87c5475d76eab519eda6176b11dbe1618fcf755bfac5311')</pre>
</div>
</div>
<div class="paragraph">
<p>We get back both the witness version and the witness program.  Those can
be inserted into the template for our output script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;version&gt; &lt;program&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>OP_0 2b626ed108ad00a944bb2922a309844611d25468
OP_1 2ceefa5fa770ff24f87c5475d76eab519eda6176b11dbe1618fcf755bfac5311</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>One
possible mistake here to be aware of is that a witness version of <code>0</code> is
for <code>OP_0</code>, which uses the byte 0x00&#8212;&#8203;but a witness version of <code>1</code> uses
<code>OP_1</code>, which is byte 0x51.  Witness versions <code>2</code> through <code>16</code> use 0x52
through 0x60, respectively.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When implementing bech32m encoding or decoding, we very strongly
recommend that you use the test vectors provided in BIP350.  We also ask
that you ensure your code passes the test vectors related to paying future segwit
versions that haven&#8217;t been defined yet.  This will help make your
software usable for many years to come even if you aren&#8217;t able to add
support for new Bitcoin features as soon as they become available.</p>
</div>
</div>
<div class="sect3">
<h4 id="priv_formats">Private Key Formats</h4>
<div class="paragraph">
<p>The private key
can be represented in a number of different formats, all of which
correspond to the same 256-bit number. <a href="#table_4-2">[table_4-2]</a> shows several common
formats used to represent private keys. Different formats are used in
different circumstances. Hexadecimal and raw binary formats are used
internally in software and rarely shown to users. The WIF is used for
import/export of keys between wallets and often used in QR code
(barcode) representations of private keys.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Modern Relevancy of Private Key Formats</div>
<div class="paragraph">
<p>Early Bitcoin wallet software generated one or more independent private
keys when a new user wallet was initialized.  When the initial set of
keys had all been used, the wallet might generate additional private
keys.  Individual private keys could be exported or imported.  Any time
new private keys were generated or imported, a new backup of the wallet
needed to be created.</p>
</div>
<div class="paragraph">
<p>Later Bitcoin wallets began using deterministic wallets where all
private keys are generated from a single seed value.  These wallets only
ever need to be backed up once for typical onchain use.  However, if a
user exports a single private key from one of these wallets and an
attacker acquires that key plus some nonprivate data about the wallet,
they can potentially derive any private key in the wallet&#8212;&#8203;allowing the
attacker to steal all of the wallet funds.  Additionally, keys cannot be
imported into deterministic wallets.  This means almost no modern
wallets support the ability to export or import an individual key.  The
information in this section is mainly of interest to anyone needing
compatibility with early Bitcoin wallets.</p>
</div>
<div class="paragraph">
<p>See <a href="#hd_wallets">[hd_wallets]</a> for more information.</p>
</div>
</div>
</div>
<table id="table_4-2">
<caption>Private key representations (encoding formats)</caption>
<thead>
<tr>
<th>Type</th>
<th>Prefix</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>Hex</p></td>
<td><p>None</p></td>
<td><p>64 hexadecimal digits</p></td>
</tr>
<tr>
<td><p>WIF</p></td>
<td><p>5</p></td>
<td><p>Base58check encoding: base58 with version prefix of 128 and 32-bit checksum</p></td>
</tr>
<tr>
<td><p>WIF-compressed</p></td>
<td><p>K or L</p></td>
<td><p>As above, with added suffix 0x01 before encoding</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#table_4-3">[table_4-3]</a> shows the private key generated in several different formats.</p>
</div>
<table id="table_4-3">
<caption>Example: Same key, different formats</caption>
<thead>
<tr>
<th>Format</th>
<th>Private key</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>Hex</p></td>
<td><p>1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd</p></td>
</tr>
<tr>
<td><p>WIF</p></td>
<td><p>5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn</p></td>
</tr>
<tr>
<td><p>WIF-compressed</p></td>
<td><p>KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All of these representations are different ways of showing the same
number, the same private key. They look different, but any one format
can easily be converted to any other format.</p>
</div>
</div>
<div class="sect3">
<h4 id="comp_priv">Compressed Private Keys</h4>
<div class="paragraph">
<p>The commonly used term "compressed private key" is a misnomer, because when a private
key is exported as WIF-compressed, it is actually one byte <em>longer</em> than
an "uncompressed" private key. That is because the private key has an
added one-byte suffix (shown as 01 in hex in <a href="#table_4-4">[table_4-4]</a>), which
signifies that the private key is from a newer wallet and should only be
used to produce compressed public keys. Private keys are not themselves
compressed and cannot be compressed. The term <em>compressed private key</em>
really means "private key from which only compressed public keys should
be derived," whereas <em>uncompressed private key</em> really means "private
key from which only uncompressed public keys should be derived." You
should only refer to the export format as "WIF-compressed" or "WIF" and
not refer to the private key itself as "compressed" to avoid further
confusion</p>
</div>
<div class="paragraph">
<p><a href="#table_4-4">[table_4-4]</a> shows the same key, encoded in WIF and WIF-compressed formats.</p>
</div>
<table id="table_4-4">
<caption>Example: Same key, different formats</caption>
<thead>
<tr>
<th>Format</th>
<th>Private key</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>Hex</p></td>
<td><p>1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD</p></td>
</tr>
<tr>
<td><p>WIF</p></td>
<td><p>5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn</p></td>
</tr>
<tr>
<td><p>Hex-compressed</p></td>
<td><p>1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD01</p></td>
</tr>
<tr>
<td><p>WIF-compressed</p></td>
<td><p>KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notice that the hex-compressed private key format has one extra byte at
the end (01 in hex). While the base58 encoding version prefix is the
same (0x80) for both WIF and WIF-compressed formats, the addition of one
byte on the end of the number causes the first character of the base58
encoding to change from a 5 to either a <em>K</em> or <em>L</em>. Think of this as the
base58 equivalent of the decimal encoding difference between the number
100 and the number 99. While 100 is one digit longer than 99, it also
has a prefix of 1 instead of a prefix of 9. As the length changes, it
affects the prefix. In base58, the prefix 5 changes to a <em>K</em> or <em>L</em> as
the length of the number increases by one byte.</p>
</div>
<div class="paragraph">
<p>Remember, these formats are <em>not</em> used interchangeably. In a newer
wallet that implements compressed public keys, the private keys will
only ever be exported as WIF-compressed (with a <em>K</em> or <em>L</em> prefix). If
the wallet is an older implementation and does not use compressed public
keys, the private keys will only ever be exported as WIF (with a 5
prefix). The goal here is to signal to the wallet importing these
private keys whether it must search the blockchain for compressed or
uncompressed public keys and addresses.</p>
</div>
<div class="paragraph">
<p>If a Bitcoin wallet is able to implement compressed public keys, it will
use those in all transactions. The private keys in the wallet will be
used to derive the public key points on the curve, which will be
compressed. The compressed public keys will be used to produce Bitcoin
addresses and those will be used in transactions. When exporting private
keys from a new wallet that implements compressed public keys, the WIF
is modified, with the addition of a one-byte suffix 01 to the private
key. The resulting base58check-encoded private key is called a
"compressed WIF" and starts with the letter <em>K</em> or <em>L</em> instead of
starting with "5," as is the case with WIF-encoded (uncompressed) keys
from older wallets.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_advanced_keys_and_addresses">Advanced Keys and Addresses</h3>
<div class="paragraph">
<p>In the
following sections we will look at advanced forms of keys and addresses,
such as vanity addresses and paper wallets.</p>
</div>
<div class="sect3">
<h4 id="_vanity_addresses">Vanity Addresses</h4>
<div class="paragraph">
<p>Vanity addresses are valid Bitcoin
addresses that contain human-readable messages. For example,
1LoveBPzzD72PUXLzCkYAtGFYmK5vYNR33 is a valid address that contains
the letters forming the word "Love" as the first four base58 letters.
Vanity addresses require generating and testing billions of candidate
private keys until a Bitcoin address with the desired pattern is found.
Although there are some optimizations in the vanity generation
algorithm, the process essentially involves picking a private key at
random, deriving the public key, deriving the Bitcoin address, and
checking to see if it matches the desired vanity pattern, repeating
billions of times until a match is found.</p>
</div>
<div class="paragraph">
<p>Once a vanity address matching the desired pattern is found, the private
key from which it was derived can be used by the owner to spend bitcoins
in exactly the same way as any other address. Vanity addresses are no
less or more secure than any other address. They depend on the same
elliptic curve cryptography (ECC) and secure hash algorithm (SHA) as any other address. You can
no more easily find the private key of an address starting with a vanity
pattern than you can any other address.</p>
</div>
<div class="paragraph">
<p>Eugenia is a children&#8217;s
charity director operating in the Philippines. Let&#8217;s say that Eugenia is
organizing a fundraising drive and wants to use a vanity Bitcoin
address to publicize the fundraising. Eugenia will create a vanity
address that starts with "1Kids" to promote the children&#8217;s charity
fundraiser. Let&#8217;s see how this vanity address will be created and what
it means for the security of Eugenia&#8217;s charity.</p>
</div>
<div class="sect4">
<h5 id="_generating_vanity_addresses">Generating vanity addresses</h5>
<div class="paragraph">
<p>It&#8217;s important to realize that a Bitcoin address is simply a number
represented by symbols in the base58 alphabet. The search for a pattern
like "1Kids" can be seen as searching for an address in the range from
1Kids11111111111111111111111111111 to
1Kidszzzzzzzzzzzzzzzzzzzzzzzzzzzzz. There are approximately 58<sup>29</sup>
(approximately 1.4 × 10<sup>51</sup>) addresses in that range, all starting with
"1Kids." <a href="#table_4-11">[table_4-11]</a> shows the range of addresses that have the
prefix 1Kids.</p>
</div>
<table id="table_4-11">
<caption>The range of vanity addresses starting with “1Kids”</caption>
<tbody>
<tr>
<td><p><strong>From</strong></p></td>
<td><p><code>1Kids11111111111111111111111111111</code></p></td>
</tr>
<tr>
<td/>
<td><p><code>1Kids11111111111111111111111111112</code></p></td>
</tr>
<tr>
<td/>
<td><p><code>1Kids11111111111111111111111111113</code></p></td>
</tr>
<tr>
<td/>
<td><p><code>…​</code></p></td>
</tr>
<tr>
<td><p><strong>To</strong></p></td>
<td><p><code>1Kidszzzzzzzzzzzzzzzzzzzzzzzzzzzzz</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Let&#8217;s look at the pattern "1Kids" as a number and see how frequently we
might find this pattern in a Bitcoin address (see <a href="#table_4-12">[table_4-12]</a>). An
average desktop computer PC, without any specialized hardware, can
search approximately 100,000 keys per second.</p>
</div>
<table id="table_4-12">
<caption>The frequency of a vanity pattern (1KidsCharity) and average search time on a desktop PC</caption>
<thead>
<tr>
<th>Length</th>
<th>Pattern</th>
<th>Frequency</th>
<th>Average search time</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>1</p></td>
<td><p>1K</p></td>
<td><p>1 in 58 keys</p></td>
<td><p>&lt; 1 milliseconds</p></td>
</tr>
<tr>
<td><p>2</p></td>
<td><p>1Ki</p></td>
<td><p>1 in 3,364</p></td>
<td><p>50 milliseconds</p></td>
</tr>
<tr>
<td><p>3</p></td>
<td><p>1Kid</p></td>
<td><p>1 in 195,000</p></td>
<td><p>&lt; 2 seconds</p></td>
</tr>
<tr>
<td><p>4</p></td>
<td><p>1Kids</p></td>
<td><p>1 in 11 million</p></td>
<td><p>1 minute</p></td>
</tr>
<tr>
<td><p>5</p></td>
<td><p>1KidsC</p></td>
<td><p>1 in 656 million</p></td>
<td><p>1 hour</p></td>
</tr>
<tr>
<td><p>6</p></td>
<td><p>1KidsCh</p></td>
<td><p>1 in 38 billion</p></td>
<td><p>2 days</p></td>
</tr>
<tr>
<td><p>7</p></td>
<td><p>1KidsCha</p></td>
<td><p>1 in 2.2 trillion</p></td>
<td><p>3–4 months</p></td>
</tr>
<tr>
<td><p>8</p></td>
<td><p>1KidsChar</p></td>
<td><p>1 in 128 trillion</p></td>
<td><p>13–18 years</p></td>
</tr>
<tr>
<td><p>9</p></td>
<td><p>1KidsChari</p></td>
<td><p>1 in 7 quadrillion</p></td>
<td><p>800 years</p></td>
</tr>
<tr>
<td><p>10</p></td>
<td><p>1KidsCharit</p></td>
<td><p>1 in 400 quadrillion</p></td>
<td><p>46,000 years</p></td>
</tr>
<tr>
<td><p>11</p></td>
<td><p>1KidsCharity</p></td>
<td><p>1 in 23 quintillion</p></td>
<td><p>2.5 million years</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As you can see, Eugenia won&#8217;t be creating the vanity address
"1KidsCharity" anytime soon, even if she had access to several thousand
computers. Each additional character increases the difficulty by a
factor of 58. Patterns with more than seven characters are usually found
by specialized hardware, such as custom-built desktops with multiple
graphics processing units (GPUs).
Vanity searches on GPU systems are many orders of magnitude
faster than on a general-purpose CPU.</p>
</div>
<div class="paragraph">
<p>Another way to find a vanity address is to outsource the work to a pool
of vanity miners. A <a href="https://oreil.ly/99K81">vanity pool</a> is a service that
allows those with fast hardware to earn bitcoin searching for vanity
addresses for others. For a fee, Eugenia can outsource the search for a
seven-character pattern vanity address and get results in a few hours
instead of having to run a CPU search for months.</p>
</div>
<div class="paragraph">
<p>Generating a vanity address is a brute-force exercise: try a random key,
check the resulting address to see if it matches the desired pattern,
repeat until successful.</p>
</div>
</div>
<div class="sect4">
<h5 id="_vanity_address_security_and_privacy">Vanity address security and privacy</h5>
<div class="paragraph">
<p>Vanity addresses were popular in the
early years of Bitcoin but have almost entirely disappeared from use as
of 2023.  There are two likely causes for this trend:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Deterministic wallets</dt>
<dd>
<p>As we saw in <a href="#recovery_code_intro">[recovery_code_intro]</a>, it&#8217;s possible to
back up every key in most modern wallets by simply writing down a few
words or characters.  This is achieved by deriving every key in the
wallet from those words or characters using a deterministic algorithm.
It&#8217;s not possible to use vanity addresses with a deterministic wallet
unless the user backs up additional data for every vanity address they
create.  More practically, most wallets using deterministic key
generation simply don&#8217;t allow importing a private key or key tweak from
a vanity generator.</p>
</dd>
<dt class="hdlist1">Avoiding address reuse</dt>
<dd>
<p>Using a vanity address to receive multiple
payments to the same address creates a link between all of those
payments.  This might be acceptable to Eugenia if her nonprofit needs
to report its income and expenditures to a tax authority anyway.
However, it also reduces the privacy of people who either pay Eugenia or
receive payments from her.  For example, Alice may want to donate
anonymously and Bob may not want his other customers to know that he
gives discount pricing to Eugenia.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>We don&#8217;t expect to see many vanity addresses in
the future unless the preceding problems are solved.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="paper_wallets">Paper Wallets</h4>
<div class="paragraph">
<p>Paper wallets are private keys printed on paper.
Often the paper wallet also includes the corresponding Bitcoin address
for convenience, but this is not necessary because it can be derived
from the private key.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Paper wallets are an OBSOLETE technology and are dangerous for most
users. There are many subtle pitfalls involved in generating them, not least of which is the possibility that the generating code is compromised
with a "back door." Many bitcoins have been stolen this way. Paper
wallets are shown here for informational purposes only and should not be
used for storing bitcoin. Use a recovery code to back up your
keys, possibly with a hardware signing device to store keys and sign transactions. DO NOT
USE PAPER <span class="keep-together">WALLETS.</span></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Paper wallets come in many designs and sizes, with many different
features. <a href="#paper_wallet_simple">An example of a simple paper wallet.</a> shows a sample paper wallet.</p>
</div>
<div id="paper_wallet_simple" class="imageblock">
<div class="content">
<img src="images/mbc3_0410.png" alt="mbc3 0410">
</div>
<div class="title">Figure 10. An example of a simple paper wallet.</div>
</div>
<div class="paragraph">
<p>Some are intended to be given as gifts and have seasonal themes, such as
Christmas and New Year&#8217;s. Others are designed for storage in a
bank vault or safe with the private key hidden in some way, either with
opaque scratch-off stickers or folded and sealed with tamper-proof
adhesive foil.  Other designs feature additional copies of the key and
address, in the form of detachable stubs similar to ticket stubs,
allowing you to store multiple copies to protect against fire, flood, or
other natural disasters.</p>
</div>
<div class="paragraph">
<p>From the original public-key focused design of Bitcoin to modern addresses
and scripts like bech32m and pay to taproot&#8212;&#8203;and even addresses for
future Bitcoin upgrades&#8212;&#8203;you&#8217;ve learned how the Bitcoin protocol allows
spenders to identify the wallets that should receive their payments.
But when it&#8217;s actually your wallet receiving the payments, you&#8217;re going
to want the assurance that you&#8217;ll still have access to that money even
if something happens to your wallet data.  In the next chapter, we&#8217;ll
look at how Bitcoin wallets are designed to protect their funds from a
variety of threats.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-03-19 23:56:16 +0800
</div>
</div>
</body>
</html>